# üß™ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## üéØ –ß—Ç–æ –º—ã –∏–∑—É—á–∏–º

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Python –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –Ω–∞—à–µ–≥–æ BookStore API –ø—Ä–æ–µ–∫—Ç–∞.

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ conftest.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest –∏ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ test_unit_basic.py       # Unit —Ç–µ—Å—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ test_api_integration.py  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã API
‚îú‚îÄ‚îÄ test_property_based.py   # Property-based —Ç–µ—Å—Ç—ã (Hypothesis)
‚îú‚îÄ‚îÄ test_performance.py      # –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ factories.py             # –§–∞–±—Ä–∏–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ locustfile.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
```bash
# –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
pytest                 # –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
pytest-asyncio         # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
pytest-cov             # –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞

# HTTP —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
httpx                  # –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API
requests               # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π HTTP –∫–ª–∏–µ–Ω—Ç

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
hypothesis             # Property-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
factory-boy            # –§–∞–±—Ä–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
faker                  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Ñ–µ–π–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
locust                 # –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
pytest-benchmark       # –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```

## üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. Unit —Ç–µ—Å—Ç—ã - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```python
# tests/test_unit_basic.py
import pytest
from bookstore.auth import get_password_hash, verify_password

class TestPasswordHashing:
    """–¢–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π"""
    
    def test_password_hashing(self):
        """–¢–µ—Å—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª—è"""
        password = "testpassword123"
        hashed = get_password_hash(password)
        
        # –•—ç—à –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º
        assert hashed != password
        # –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å
        assert verify_password(password, hashed)
    
    def test_different_passwords_different_hashes(self):
        """–†–∞–∑–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –¥–∞–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ö—ç—à–∏"""
        password1 = "password1"
        password2 = "password2"
        
        hash1 = get_password_hash(password1)
        hash2 = get_password_hash(password2)
        
        assert hash1 != hash2
    
    def test_wrong_password_verification_fails(self):
        """–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é"""
        password = "correct_password"
        wrong_password = "wrong_password"
        hashed = get_password_hash(password)
        
        assert not verify_password(wrong_password, hashed)
```

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –≤ Unit —Ç–µ—Å—Ç–∞—Ö:**
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã
- ‚úÖ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£—Ç–∏–ª–∏—Ç—ã –∏ —Ö–µ–ª–ø–µ—Ä—ã

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π

```python
# tests/test_api_integration.py
import pytest
from httpx import AsyncClient

class TestUserAPI:
    """–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã API –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    
    async def test_create_user_success(self, client: AsyncClient):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        user_data = {
            "email": "test@example.com",
            "username": "testuser",
            "password": "password123",
            "full_name": "Test User"
        }
        
        response = await client.post("/api/v1/users/", json=user_data)
        
        assert response.status_code == 201
        data = response.json()
        assert data["email"] == user_data["email"]
        assert data["username"] == user_data["username"]
        assert "password" not in data  # –ü–∞—Ä–æ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è
    
    async def test_create_user_duplicate_email(self, client: AsyncClient, test_user):
        """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º—Å—è email"""
        user_data = {
            "email": test_user.email,  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π email
            "username": "newuser",
            "password": "password123"
        }
        
        response = await client.post("/api/v1/users/", json=user_data)
        
        assert response.status_code == 400
        assert "already registered" in response.json()["detail"]
    
    async def test_login_success(self, client: AsyncClient, test_user):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É"""
        login_data = {
            "username": test_user.email,
            "password": "password123"
        }
        
        response = await client.post("/auth/login", data=login_data)
        
        assert response.status_code == 200
        data = response.json()
        assert "access_token" in data
        assert data["token_type"] == "bearer"
```

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö:**
- ‚úÖ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### 3. Property-based —Ç–µ—Å—Ç—ã - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤

```python
# tests/test_property_based.py
import pytest
from hypothesis import given, strategies as st, assume
from bookstore.auth import get_password_hash, verify_password

class TestPasswordProperties:
    """Property-based —Ç–µ—Å—Ç—ã –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø–∞—Ä–æ–ª–µ–π"""
    
    @given(password=st.text(min_size=1, max_size=100))
    def test_password_hash_roundtrip(self, password):
        """–°–≤–æ–π—Å—Ç–≤–æ: —Ö—ç—à –ø–∞—Ä–æ–ª—è –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ"""
        # –ò—Å–∫–ª—é—á–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç—Ä–æ–∫–∏ —Ç–æ–ª—å–∫–æ –∏–∑ –ø—Ä–æ–±–µ–ª–æ–≤
        assume(password.strip())
        
        hashed = get_password_hash(password)
        
        # –û—Å–Ω–æ–≤–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
        assert hashed != password  # –•—ç—à –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
        assert verify_password(password, hashed)  # –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
        assert len(hashed) > 0  # –•—ç—à –Ω–µ –ø—É—Å—Ç–æ–π
    
    @given(
        password1=st.text(min_size=1, max_size=50),
        password2=st.text(min_size=1, max_size=50)
    )
    def test_different_passwords_different_hashes(self, password1, password2):
        """–°–≤–æ–π—Å—Ç–≤–æ: —Ä–∞–∑–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Ö—ç—à–∏"""
        assume(password1 != password2)
        assume(password1.strip() and password2.strip())
        
        hash1 = get_password_hash(password1)
        hash2 = get_password_hash(password2)
        
        assert hash1 != hash2

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
@st.composite
def valid_email(draw):
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∞–ª–∏–¥–Ω—ã—Ö email –∞–¥—Ä–µ—Å–æ–≤"""
    username = draw(st.text(
        alphabet=st.characters(whitelist_categories=('Lu', 'Ll', 'Nd')),
        min_size=1, max_size=20
    ))
    domain = draw(st.sampled_from(['example.com', 'test.org', 'demo.net']))
    return f"{username}@{domain}"

@st.composite
def valid_book_data(draw):
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–Ω–∏–≥"""
    return {
        "title": draw(st.text(min_size=1, max_size=200)),
        "description": draw(st.text(max_size=1000)),
        "price": draw(st.floats(min_value=0, max_value=10000, allow_nan=False)),
        "isbn": draw(st.text(min_size=10, max_size=13, alphabet=st.characters(whitelist_categories=('Nd',))))
    }
```

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –≤ property-based —Ç–µ—Å—Ç–∞—Ö:**
- ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (—á—Ç–æ –¥–æ–ª–∂–Ω–æ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º)
- ‚úÖ –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
- ‚úÖ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞
- ‚úÖ Round-trip –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è)

### 4. –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```python
# tests/test_performance.py
import time
import pytest
from httpx import AsyncClient

class TestPerformance:
    """–¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API"""
    
    async def test_book_search_performance(self, client: AsyncClient, sample_books):
        """–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∏—Å–∫–∞ –∫–Ω–∏–≥"""
        # –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        await self.create_test_books(client, count=100)
        
        # –ò–∑–º–µ—Ä—è–µ–º –≤—Ä–µ–º—è –ø–æ–∏—Å–∫–∞
        start_time = time.perf_counter()
        
        response = await client.get("/api/v1/books/?q=test&limit=20")
        
        end_time = time.perf_counter()
        duration = end_time - start_time
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        assert response.status_code == 200
        assert duration < 0.1  # –ü–æ–∏—Å–∫ –¥–æ–ª–∂–µ–Ω –∑–∞–Ω–∏–º–∞—Ç—å –º–µ–Ω–µ–µ 100ms
        
        data = response.json()
        assert len(data["items"]) <= 20
    
    async def test_concurrent_requests(self, client: AsyncClient):
        """–¢–µ—Å—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤"""
        import asyncio
        
        async def make_request():
            response = await client.get("/api/v1/books/")
            return response.status_code
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º 10 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
        start_time = time.perf_counter()
        
        tasks = [make_request() for _ in range(10)]
        results = await asyncio.gather(*tasks)
        
        end_time = time.perf_counter()
        duration = end_time - start_time
        
        # –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å–ø–µ—à–Ω—ã–º–∏
        assert all(status == 200 for status in results)
        # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–Ω–∏–º–∞—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
        assert duration < 1.0
    
    @pytest.mark.benchmark
    def test_password_hashing_benchmark(self, benchmark):
        """–ë–µ–Ω—á–º–∞—Ä–∫ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π"""
        password = "test_password_123"
        
        # –ò–∑–º–µ—Ä—è–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
        result = benchmark(get_password_hash, password)
        
        assert len(result) > 0
        assert result != password
```

## üè≠ –§–∞–±—Ä–∏–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### Factory Boy –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤

```python
# tests/factories.py
import factory
from factory.alchemy import SQLAlchemyModelFactory
from faker import Faker
from bookstore.models import User, Book, Author, Genre
from bookstore.database import SessionLocal

fake = Faker(['ru_RU', 'en_US'])

class UserFactory(SQLAlchemyModelFactory):
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    
    class Meta:
        model = User
        sqlalchemy_session_persistence = "commit"
    
    email = factory.LazyAttribute(lambda obj: fake.unique.email())
    username = factory.LazyAttribute(lambda obj: fake.unique.user_name())
    full_name = factory.LazyAttribute(lambda obj: fake.name())
    hashed_password = factory.LazyAttribute(
        lambda obj: get_password_hash("password123")
    )
    is_active = True
    is_superuser = False

class AuthorFactory(SQLAlchemyModelFactory):
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–≤—Ç–æ—Ä–æ–≤"""
    
    class Meta:
        model = Author
        sqlalchemy_session_persistence = "commit"
    
    name = factory.LazyAttribute(lambda obj: fake.name())
    biography = factory.LazyAttribute(lambda obj: fake.text(max_nb_chars=500))
    birth_date = factory.LazyAttribute(
        lambda obj: fake.date_between(start_date='-100y', end_date='-20y')
    )

class BookFactory(SQLAlchemyModelFactory):
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–∏–≥"""
    
    class Meta:
        model = Book
        sqlalchemy_session_persistence = "commit"
    
    title = factory.LazyAttribute(lambda obj: fake.sentence(nb_words=4)[:-1])
    description = factory.LazyAttribute(lambda obj: fake.text(max_nb_chars=1000))
    price = factory.LazyAttribute(lambda obj: fake.pydecimal(
        left_digits=3, right_digits=2, positive=True, min_value=1, max_value=999
    ))
    isbn = factory.LazyAttribute(lambda obj: fake.isbn13())
    publication_date = factory.LazyAttribute(
        lambda obj: fake.date_between(start_date='-50y', end_date='today')
    )
    
    # –°–≤—è–∑–∏ many-to-many
    @factory.post_generation
    def authors(self, create, extracted, **kwargs):
        if not create:
            return
        
        if extracted:
            for author in extracted:
                self.authors.append(author)
        else:
            # –°–æ–∑–¥–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞
            author = AuthorFactory()
            self.authors.append(author)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∞–±—Ä–∏–∫ –≤ —Ç–µ—Å—Ç–∞—Ö
def test_user_creation():
    """–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–∞–±—Ä–∏–∫–∏"""
    user = UserFactory()
    assert user.email
    assert user.username
    assert user.hashed_password

def test_book_with_authors():
    """–°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ —Å –∞–≤—Ç–æ—Ä–∞–º–∏"""
    authors = AuthorFactory.create_batch(2)
    book = BookFactory(authors=authors)
    
    assert len(book.authors) == 2
    assert book.title
    assert book.price > 0
```

### Faker –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```python
from faker import Faker

# –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤
fake = Faker(['ru_RU', 'en_US'])

# –ü—Ä–∏–º–µ—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
name = fake.name()                    # "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤"
email = fake.email()                  # "ivan@example.com"
text = fake.text(max_nb_chars=500)    # –°–ª—É—á–∞–π–Ω—ã–π —Ç–µ–∫—Å—Ç
date = fake.date_between(start_date='-1y', end_date='today')
phone = fake.phone_number()           # –¢–µ–ª–µ—Ñ–æ–Ω
address = fake.address()              # –ê–¥—Ä–µ—Å
company = fake.company()              # –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
isbn = fake.isbn13()                  # ISBN –∫–Ω–∏–≥–∏
price = fake.pydecimal(left_digits=3, right_digits=2, positive=True)
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest

### conftest.py - –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```python
# tests/conftest.py
import pytest
import asyncio
from httpx import AsyncClient
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from bookstore.main import app
from bookstore.database import get_db, Base
from bookstore.config import get_settings

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
settings = get_settings()
SQLALCHEMY_DATABASE_URL = "sqlite:///./test.db"

engine = create_engine(
    SQLALCHEMY_DATABASE_URL, 
    connect_args={"check_same_thread": False}
)
TestingSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

@pytest.fixture(scope="session")
def event_loop():
    """–°–æ–∑–¥–∞–Ω–∏–µ event loop –¥–ª—è –≤—Å–µ–π —Å–µ—Å—Å–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    loop = asyncio.get_event_loop_policy().new_event_loop()
    yield loop
    loop.close()

@pytest.fixture
def db_session():
    """–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö"""
    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã
    Base.metadata.create_all(bind=engine)
    
    db = TestingSessionLocal()
    try:
        yield db
    finally:
        db.close()
        # –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
        Base.metadata.drop_all(bind=engine)

@pytest.fixture
async def client(db_session):
    """–§–∏–∫—Å—Ç—É—Ä–∞ HTTP –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API"""
    
    def override_get_db():
        try:
            yield db_session
        finally:
            db_session.close()
    
    app.dependency_overrides[get_db] = override_get_db
    
    async with AsyncClient(app=app, base_url="http://test") as test_client:
        yield test_client
    
    app.dependency_overrides.clear()

@pytest.fixture
def test_user(db_session):
    """–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    from tests.factories import UserFactory
    UserFactory._meta.sqlalchemy_session = db_session
    return UserFactory()

@pytest.fixture
def admin_user(db_session):
    """–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"""
    from tests.factories import UserFactory
    UserFactory._meta.sqlalchemy_session = db_session
    return UserFactory(is_superuser=True)

@pytest.fixture
async def authenticated_client(client: AsyncClient, test_user):
    """–§–∏–∫—Å—Ç—É—Ä–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞"""
    # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω
    login_data = {
        "username": test_user.email,
        "password": "password123"
    }
    response = await client.post("/auth/login", data=login_data)
    token = response.json()["access_token"]
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    client.headers.update({"Authorization": f"Bearer {token}"})
    return client
```

### pytest.ini - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest

```ini
# pytest.ini
[tool:pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# –ú–∞—Ä–∫–µ—Ä—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
markers =
    unit: Unit tests
    integration: Integration tests
    property: Property-based tests
    performance: Performance tests
    slow: Slow tests that take more than 1 second

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
addopts = 
    --cov=bookstore
    --cov-report=html
    --cov-report=term-missing
    --cov-fail-under=80
    --strict-markers
    -v

# –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
asyncio_mode = auto

# –§–∏–ª—å—Ç—Ä—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
```

## üìä –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=bookstore

# HTML –æ—Ç—á–µ—Ç (—Å–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É htmlcov/)
pytest --cov=bookstore --cov-report=html

# –ü–æ–∫–∞–∑–∞—Ç—å –Ω–µ–ø–æ–∫—Ä—ã—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
pytest --cov=bookstore --cov-report=term-missing

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –ø–æ–∫—Ä—ã—Ç–∏—è
pytest --cov=bookstore --cov-fail-under=90

# –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
pytest --cov=bookstore --cov-report=term-missing --cov-branch
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–∫—Ä—ã—Ç–∏—è (.coveragerc)

```ini
# .coveragerc
[run]
source = bookstore
omit = 
    */tests/*
    */venv/*
    */migrations/*
    */conftest.py
    */settings/*

[report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:

[html]
directory = htmlcov
```

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
pytest tests/test_unit_basic.py

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_unit_basic.py::TestPasswordHashing::test_password_hashing

# –¢–µ—Å—Ç—ã –ø–æ –º–∞—Ä–∫–µ—Ä–∞–º
pytest -m unit                    # –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
pytest -m "not slow"              # –ò—Å–∫–ª—é—á–∏—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest -m "unit or integration"   # Unit –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ

# –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
pytest -n auto                    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pytest -n 4                       # 4 –ø—Ä–æ—Ü–µ—Å—Å–∞

# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
pytest -v                         # Verbose
pytest -s                         # –ü–æ–∫–∞–∑–∞—Ç—å print statements
pytest --tb=short                 # –ö–æ—Ä–æ—Ç–∫–∏–π traceback

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
pytest -x

# –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ —É–ø–∞–≤—à–∏—Ö —Ç–µ—Å—Ç–æ–≤
pytest --lf                       # Last failed
pytest --ff                       # Failed first
```

### Makefile –∫–æ–º–∞–Ω–¥—ã

```makefile
# Makefile
test:
	pytest

test-unit:
	pytest -m unit

test-integration:
	pytest -m integration

test-property:
	pytest -m property --hypothesis-show-statistics

test-performance:
	pytest -m performance

test-coverage:
	pytest --cov=bookstore --cov-report=html --cov-report=term-missing

test-fast:
	pytest -m "not slow" -x

test-parallel:
	pytest -n auto
```

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤ (AAA Pattern)

```python
def test_user_creation():
    # Arrange (–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
    user_data = {
        "email": "test@example.com",
        "username": "testuser",
        "password": "password123"
    }
    
    # Act (–î–µ–π—Å—Ç–≤–∏–µ)
    user = create_user(user_data)
    
    # Assert (–ü—Ä–æ–≤–µ—Ä–∫–∞)
    assert user.email == user_data["email"]
    assert user.username == user_data["username"]
    assert user.id is not None
```

### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

```python
# ‚úÖ –•–æ—Ä–æ—à–æ - –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
def test_user_creation_with_valid_data_succeeds():
    pass

def test_user_creation_with_duplicate_email_fails():
    pass

def test_password_hashing_produces_different_hash_each_time():
    pass

# ‚ùå –ü–ª–æ—Ö–æ - –Ω–µ–æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
def test_user():
    pass

def test_create():
    pass

def test_password():
    pass
```

### –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

```python
# ‚úÖ –•–æ—Ä–æ—à–æ - –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º
class TestUserService:
    def test_create_user(self, db_session):
        user = UserFactory()
        assert user.id is not None
    
    def test_get_user_by_id(self, db_session):
        user = UserFactory()
        found_user = get_user_by_id(db_session, user.id)
        assert found_user.id == user.id

# ‚ùå –ü–ª–æ—Ö–æ - —Ç–µ—Å—Ç—ã –∑–∞–≤–∏—Å—è—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞
class TestUserService:
    def test_create_user(self, db_session):
        self.user = UserFactory()  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ self
    
    def test_get_user_by_id(self, db_session):
        # –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç–µ—Å—Ç–∞
        found_user = get_user_by_id(db_session, self.user.id)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä

```python
# ‚úÖ –•–æ—Ä–æ—à–æ - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
@pytest.fixture
def user_data():
    """–ë–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    return {
        "email": "test@example.com",
        "username": "testuser",
        "password": "password123"
    }

@pytest.fixture
def test_user(db_session, user_data):
    """–°–æ–∑–¥–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ë–î"""
    return UserFactory(**user_data)

# ‚ùå –ü–ª–æ—Ö–æ - –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
@pytest.fixture
def everything_fixture(db_session):
    """–°–æ–∑–¥–∞–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã"""
    users = UserFactory.create_batch(10)
    books = BookFactory.create_batch(50)
    authors = AuthorFactory.create_batch(20)
    # ... –º–Ω–æ–≥–æ –Ω–µ–Ω—É–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    return {
        'users': users,
        'books': books,
        'authors': authors
    }
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- **80%+** - —Ö–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **90%+** - –æ—Ç–ª–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ  
- **95%+** - –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **100%** - –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ

### –¢–∏–ø—ã –ø–æ–∫—Ä—ã—Ç–∏—è
- **Line coverage** - –ø–æ–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **Branch coverage** - –ø–æ–∫—Ä—ã—Ç–∏–µ –≤–µ—Ç–≤–ª–µ–Ω–∏–π (if/else)
- **Function coverage** - –ø–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
- **Condition coverage** - –ø–æ–∫—Ä—ã—Ç–∏–µ —É—Å–ª–æ–≤–∏–π

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤
- **Unit —Ç–µ—Å—Ç—ã**: < 1ms –∫–∞–∂–¥—ã–π
- **Integration —Ç–µ—Å—Ç—ã**: < 100ms –∫–∞–∂–¥—ã–π
- **E2E —Ç–µ—Å—Ç—ã**: < 1s –∫–∞–∂–¥—ã–π
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: < 5 –º–∏–Ω—É—Ç –¥–ª—è –≤—Å–µ–≥–æ –Ω–∞–±–æ—Ä–∞

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **Flaky tests**: < 1% (–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã)
- **False positives**: –º–∏–Ω–∏–º—É–º
- **False negatives**: –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã

## üîç –û—Ç–ª–∞–¥–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ –æ–ø—Ü–∏–∏ pytest

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
pytest -x

# –ü–æ–¥—Ä–æ–±–Ω—ã–π traceback
pytest --tb=long

# –ü–æ–∫–∞–∑–∞—Ç—å print statements
pytest -s

# –ó–∞–ø—É—Å–∫ –≤ –æ—Ç–ª–∞–¥—á–∏–∫–µ
pytest --pdb

# –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤
pytest --durations=10

# –ü–æ–∫–∞–∑–∞—Ç—å —Å–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest --durations=0
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö

```python
import logging

def test_with_logging(caplog):
    """–¢–µ—Å—Ç —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ª–æ–≥–æ–≤"""
    with caplog.at_level(logging.INFO):
        function_that_logs_info()
    
    assert "Expected log message" in caplog.text
    assert caplog.records[0].levelname == "INFO"

def test_with_custom_logger(caplog):
    """–¢–µ—Å—Ç —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º –ª–æ–≥–≥–µ—Ä–æ–º"""
    logger = logging.getLogger("bookstore.auth")
    
    with caplog.at_level(logging.DEBUG, logger="bookstore.auth"):
        logger.debug("Debug message")
    
    assert "Debug message" in caplog.text
```

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –ß—Ç–æ –º—ã –∏–∑—É—á–∏–ª–∏

**–¢–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
- ‚úÖ Unit —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è API
- ‚úÖ Property-based —Ç–µ—Å—Ç—ã –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- ‚úÖ pytest –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- ‚úÖ Factory Boy –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Hypothesis –¥–ª—è property-based —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ httpx –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API

**–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:**
- ‚úÖ AAA –ø–∞—Ç—Ç–µ—Ä–Ω (Arrange, Act, Assert)
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
- ‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ pytest.ini
- ‚úÖ Makefile –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
- ‚úÖ CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–∞–∫—Ç–∏–∫–∞**: –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è —Å–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
2. **CI/CD**: –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç—ã –≤ –ø–∞–π–ø–ª–∞–π–Ω
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
4. **–û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã**: –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –∑–Ω–∞–Ω–∏—è–º–∏

**–ü–æ–º–Ω–∏—Ç–µ**: –•–æ—Ä–æ—à–∏–µ —Ç–µ—Å—Ç—ã - —ç—Ç–æ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è –≤ –±—É–¥—É—â–µ–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞! üöÄ